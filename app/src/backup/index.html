<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Outlet Control</title>
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no" />
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.14.8/react.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.14.8/react-dom.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.6.16/browser.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.2/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/0.3.5/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.1.6/Chart.min.js"></script>
        

    <!-- material design -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.6/css/materialize.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.6/js/materialize.min.js"></script>

    <link rel="stylesheet" href="css/base.css" />
  </head>
  <body>
    <canvas id="myChart" width="400" height="400"></canvas>
    <div id="content"></div>
    <script type="text/babel" src="scripts/outlet_app.js"></script>

    <script src="https://cdn.firebase.com/js/client/2.4.2/firebase.js"></script>
    <script src="https://www.gstatic.com/firebasejs/live/3.0/firebase.js"></script>
    <script>
      // Initialize Firebase
      var config = {
        apiKey: "AIzaSyCEHwKtXIkMX6RZ7cplrSTJ9hA3o6vCyl4",
        authDomain: "project-3654207232474154346.firebaseapp.com",
        databaseURL: "https://project-3654207232474154346.firebaseio.com",
        storageBucket: "project-3654207232474154346.appspot.com",
      };
      firebase.initializeApp(config);
      var ref = new Firebase("https://project-3654207232474154346.firebaseio.com/");
      var database = firebase.database();    

    
    //Firebase.
    ref.child("weather").limitToLast(400).on("value", function(snapshot) {
      var dataVal = snapshot.val();
      var keys = Object.keys(dataVal);
      var tempearture = [];
      var labels = [];

      for(var i=0; i<keys.length; i++) {
        if (i % 4 == 0) {
          tempearture.push(dataVal[keys[i]].temperature);          
          labels.push("");
        }
          
      }
      
      
      var ctx = document.getElementById("myChart");
      var myChart = new Chart(ctx, {
          type: 'line',          
          data: {
              labels: labels,
              datasets: [{
                  label: "My First dataset",
                  fill: true,
                  lineTension: 0.1,
                  backgroundColor: "rgba(75,192,192,0.4)",
                  borderColor: "rgba(75,192,192,1)",
                  borderCapStyle: 'butt',
                  borderDash: [],
                  borderDashOffset: 0.0,
                  borderJoinStyle: 'miter',
                  pointBorderColor: "rgba(75,192,192,1)",
                  pointBackgroundColor: "#fff",
                  pointBorderWidth: 1,
                  pointRadius: 1,
                  pointHitRadius: 10,
                  data: tempearture,              
              }]
          },        
      });
    });      
    </script>

  </body>
</html>
